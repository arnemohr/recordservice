From d3f909724e15501694f505afeb7c55ed8827be42 Mon Sep 17 00:00:00 2001
From: Srikanth Srungarapu <ssrungarapu@cloudera.com>
Date: Fri, 10 Apr 2015 13:44:19 -0700
Subject: [PATCH 255/268] HBASE-13436 Include user name in ADE for scans

Reason: Supportability
Author: Srikanth Srungarapu
Ref: CDH-31924
---
 .../hbase/security/access/AccessController.java    |    5 +++--
 1 files changed, 3 insertions(+), 2 deletions(-)

diff --git a/hbase-server/src/main/java/org/apache/hadoop/hbase/security/access/AccessController.java b/hbase-server/src/main/java/org/apache/hadoop/hbase/security/access/AccessController.java
index fa91fc2..d1d12df 100644
--- a/hbase-server/src/main/java/org/apache/hadoop/hbase/security/access/AccessController.java
+++ b/hbase-server/src/main/java/org/apache/hadoop/hbase/security/access/AccessController.java
@@ -1518,8 +1518,9 @@ public class AccessController extends BaseMasterAndRegionObserver
 
     logResult(authResult);
     if (!authResult.isAllowed()) {
-      throw new AccessDeniedException("Insufficient permissions (table=" + table +
-        ", action=READ)");
+      throw new AccessDeniedException("Insufficient permissions for user '"
+          + (user != null ? user.getShortName() : "null")
+          + "' (table=" + table + ", action=READ)");
     }
   }
 
-- 
1.7.0.4

